{% extends 'base.html' %}
{% block content %}

    <div class="signup-section" id="signup-section>
      {% csrf_token %}
      <input type="email" id="id_email">
      <input type="text" placeholder="username" id="id_username">
      <input type="password" placeholder="password" id="id_password">
      <span id="login-btn"><button onclick="login()">login</button></span>
      <span id="signup-btn"><button onclick="signupget()">signup</button> </span>
      <span id="signup-btn-submit"><button onclick="signup()">signup</button> </span>
    </div>

<script>
    document.getElementById('id_email').style.display = 'none'
    document.getElementById('signup-btn').style.display = 'none'
    document.getElementById('signup-btn-submit').style.display = 'none'

    function login(){
      let username = document.getElementById('id_username').value;
      let password = document.getElementById('id_password').value;
      let csrf_token = document.querySelector('[name=csrfmiddlewaretoken]').value
      // let csrftoken = document.querySelector('[name=csrfmiddlewaretoken]').value;
      url = 'http://127.0.0.1:8000/api/signin'
      fetch(url,{
        method : 'POST',
        body : JSON.stringify({'username':username,'password' : password}),
        headers : {
          'Accept' : 'application/json',
          'X-CSRFToken' : csrf_token,
        }
      }).then((data)=>{
        if(data.status == 'success'){
        data = data.json()
        localStorage.setItem('token') = data.token
        localStorage.setItem('user_id') = data.id
        document.getElementById('signup_section').style.display = 'none'
        }
      })
    }
</script>
{% endblock %}